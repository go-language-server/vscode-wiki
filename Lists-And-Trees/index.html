



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Personal fork of Visual Studio Code Wiki">
      
      
        <link rel="canonical" href="https://go-language-server.github.io/vscode-wiki/Lists-And-Trees/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Lists And Trees - Visual Studio Code Wiki</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
      <script src="../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-89201129-1", "https://go-language-server.github.io/vscode-wiki/")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#lists-and-trees" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://go-language-server.github.io/vscode-wiki/" title="Visual Studio Code Wiki" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Visual Studio Code Wiki
            </span>
            <span class="md-header-nav__topic">
              
                Lists And Trees
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/go-language-server/vscode-wiki/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    zchee/golang-wiki
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://go-language-server.github.io/vscode-wiki/" title="Visual Studio Code Wiki" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Visual Studio Code Wiki
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/go-language-server/vscode-wiki/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    zchee/golang-wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../Home/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Project Management
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Project Management
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Roadmap/" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Iteration-Plans/" title="Iteration Plans" class="md-nav__link">
      Iteration Plans
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Development-Process/" title="Development Process" class="md-nav__link">
      Development Process
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      Issue Tracking
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        Issue Tracking
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Issue-Tracking/" title="Issue Tracking" class="md-nav__link">
      Issue Tracking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Issues-Triaging/" title="Issues Triaging" class="md-nav__link">
      Issues Triaging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Performance-Issues/" title="Performance Issues" class="md-nav__link">
      Performance Issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Community-Issue-Tracking/" title="Community Issue Tracking" class="md-nav__link">
      Community Issue Tracking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Keybinding-Issues/" title="Keybinding Issues" class="md-nav__link">
      Keybinding Issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Native-Crash-Issues/" title="Native Crash Issues" class="md-nav__link">
      Native Crash Issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Search-Issues/" title="Search Issues" class="md-nav__link">
      Search Issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Issue-Grooming/" title="Issue Grooming" class="md-nav__link">
      Issue Grooming
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Build-Master/" title="Build Master" class="md-nav__link">
      Build Master
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Release-Process/" title="Release Process" class="md-nav__link">
      Release Process
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Running-the-Endgame/" title="Running the Endgame" class="md-nav__link">
      Running the Endgame
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Related-Projects/" title="Related Projects" class="md-nav__link">
      Related Projects
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Contributing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Contributing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../How-to-Contribute/" title="How to Contribute" class="md-nav__link">
      How to Contribute
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Submitting-Bugs-and-Suggestions/" title="Submitting Bugs and Suggestions" class="md-nav__link">
      Submitting Bugs and Suggestions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Feedback-Channels/" title="Feedback Channels" class="md-nav__link">
      Feedback Channels
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Source-Code-Organization/" title="Source Code Organization" class="md-nav__link">
      Source Code Organization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Coding-Guidelines/" title="Coding Guidelines" class="md-nav__link">
      Coding Guidelines
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Smoke-Test/" title="Smoke Test" class="md-nav__link">
      Smoke Test
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Contributor-License-Agreement/" title="Contributor License Agreement" class="md-nav__link">
      Contributor License Agreement
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://github.com/Microsoft/vscode/wiki/Requested-Extensions" title="Requested Extensions" class="md-nav__link">
      Requested Extensions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Extension-API-guidelines/" title="Extension API Guidelines" class="md-nav__link">
      Extension API Guidelines
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Documentation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Documentation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="https://code.visualstudio.com/docs/extensions/overview" title="Extensions" class="md-nav__link">
      Extensions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://code.visualstudio.com/docs/extensionAPI/overview" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://code.visualstudio.com/docs" title="Visual Studio Code" class="md-nav__link">
      Visual Studio Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://github.com/microsoft/vscode-docs" title="Document Repository" class="md-nav__link">
      Document Repository
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://github.com/Microsoft/vscode/wiki/Adopting-Multi-Root-Workspace-APIs" title="Multi Root Workspace API" class="md-nav__link">
      Multi Root Workspace API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Adopting-Multi-Root-Workspace-APIs/" title="Adopting Multi Root Workspace APIs" class="md-nav__link">
      Adopting Multi Root Workspace APIs
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Code-Editor-Roadmap/" title="Code Editor Roadmap" class="md-nav__link">
      Code Editor Roadmap
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Color-customization-color-id-changes/" title="Color customization color id changes" class="md-nav__link">
      Color customization color id changes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Cross-Compiling-for-Debian-Based-Linux/" title="Cross Compiling for Debian Based Linux" class="md-nav__link">
      Cross Compiling for Debian Based Linux
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../December-Pre-Release/" title="December Pre Release" class="md-nav__link">
      December Pre Release
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../December-Test-Plan/" title="December Test Plan" class="md-nav__link">
      December Test Plan
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Design-Goals/" title="Design Goals" class="md-nav__link">
      Design Goals
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Differences-between-the-repository-and-Visual-Studio-Code/" title="Differences between the repository and Visual Studio Code" class="md-nav__link">
      Differences between the repository and Visual Studio Code
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Editor-decorations-&-colors/" title="Editor decorations & colors" class="md-nav__link">
      Editor decorations & colors
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Explain-extension-causes-high-cpu-load/" title="Explain extension causes high cpu load" class="md-nav__link">
      Explain extension causes high cpu load
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Extension-API-process/" title="Extension API process" class="md-nav__link">
      Extension API process
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Feature-Areas/" title="Feature Areas" class="md-nav__link">
      Feature Areas
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../IME-Test/" title="IME Test" class="md-nav__link">
      IME Test
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Insiders-Release-Notes/" title="Insiders Release Notes" class="md-nav__link">
      Insiders Release Notes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Known-issues/" title="Known issues" class="md-nav__link">
      Known issues
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Lists And Trees
      </label>
    
    <a href="./" title="Lists And Trees" class="md-nav__link md-nav__link--active">
      Lists And Trees
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#widgets" class="md-nav__link">
    Widgets
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list" class="md-nav__link">
    List
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index-tree" class="md-nav__link">
    Index Tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object-tree" class="md-nav__link">
    Object Tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-tree" class="md-nav__link">
    Data Tree
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    Performance
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../November-Plan/" title="November Plan" class="md-nav__link">
      November Plan
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Performance-Issues-(old)/" title="Performance Issues (old)" class="md-nav__link">
      Performance Issues (old)
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Pointer-Device--&-Touch-support/" title="Pointer Device & Touch support" class="md-nav__link">
      Pointer Device  & Touch support
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Publish-vscode-types/" title="Publish vscode types" class="md-nav__link">
      Publish vscode types
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Removing-Insiders/" title="Removing Insiders" class="md-nav__link">
      Removing Insiders
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Roadmap-2017/" title="Roadmap 2017" class="md-nav__link">
      Roadmap 2017
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Roadmap-2018/" title="Roadmap 2018" class="md-nav__link">
      Roadmap 2018
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Roadmap-2019/" title="Roadmap 2019" class="md-nav__link">
      Roadmap 2019
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Semantic-Highlighting-Overview/" title="Semantic Highlighting Overview" class="md-nav__link">
      Semantic Highlighting Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Setting-Descriptions/" title="Setting Descriptions" class="md-nav__link">
      Setting Descriptions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Terminal-Issues/" title="Terminal Issues" class="md-nav__link">
      Terminal Issues
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../UX/" title="UX" class="md-nav__link">
      UX
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Working-with-xterm.js/" title="Working with xterm.js" class="md-nav__link">
      Working with xterm.js
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../[WIP]-Code-Editor-Design-Doc/" title="[WIP] Code Editor Design Doc" class="md-nav__link">
      [WIP] Code Editor Design Doc
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../[WIP]-Design-Checklist/" title="[WIP] Design Checklist" class="md-nav__link">
      [WIP] Design Checklist
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../[WIP]-Design-Principles/" title="[WIP] Design Principles" class="md-nav__link">
      [WIP] Design Principles
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#widgets" class="md-nav__link">
    Widgets
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#list" class="md-nav__link">
    List
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#index-tree" class="md-nav__link">
    Index Tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object-tree" class="md-nav__link">
    Object Tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-tree" class="md-nav__link">
    Data Tree
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    Performance
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/go-language-server/vscode-wiki/edit/master/docs/Lists-And-Trees.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="lists-and-trees">Lists and Trees</h1>
<p>In October-November 2018, we addressed some performance issues of our tree widget. In doing so, we took the chance to rewrite it and ended up creating a couple of different widgets available to use within VS Code. This document aims to introduce the core list and tree widgets available, as well as summarize each widget's particularities, which should help in choosing what widget to use. Finally, we present some performance numbers after adopting the new <code>ObjectTree</code> in the Problems panel.</p>
<h2 id="widgets">Widgets</h2>
<p>All the following widgets are compositions of one another. Let's start with the bottom of the composition chain: the list.</p>
<h3 id="list">List</h3>
<p>At its core, the List is a <strong><em>virtual</em> rendering engine</strong>. It can render a collection of elements in a scrollable view, while making sure only the visible elements actually end up in the DOM at any given point in time. Scrolling up and down will trigger a series of computations to determine whether DOM elements should be inserted in or removed from the document. Minimizing DOM access is what lets the List scale to large quantities and keep up with performance. You can easily add 100k elements to it without breaking a sweat.</p>
<p>A requirement of virtual rendering is the need to know each element's height in pixels before it gets rendered. At runtime, the list will ask the height to a provided virtual rendering controller, keep an in-memory map of each element's height and track the viewport's position in order to know which elements should be rendered in and out of the DOM. Note that each item can have its own height.</p>
<blockquote>
<p>List splice animation</p>
</blockquote>
<p>Given that the collection model for a list is a simple array, the API to modify a list's element collection is very simple. The <code>splice</code> call allows for deleting and inserting continuous items in the list. Here's a simplified version of it:</p>
<div class="highlight"><pre><span></span><span class="kr">class</span> <span class="nx">List</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="nx">splice</span><span class="p">(</span><span class="nx">start</span>: <span class="kt">number</span><span class="p">,</span> <span class="nx">deleteCount</span>: <span class="kt">number</span><span class="p">,</span> <span class="nx">toInsert</span>: <span class="kt">T</span><span class="p">[])</span><span class="o">:</span> <span class="k">void</span>
<span class="p">}</span>
</pre></div>

<p>Apart from being a virtual rendering engine, the <code>List</code> provides quite a lot of functionality that actually make it a usable widget: keyboard and mouse navigation, focus and selection traits, accessibility roles, etc. These features are what defines <code>List</code> as a usable widget across our workbench.</p>
<h3 id="index-tree">Index Tree</h3>
<p>A tree UI widget should be able to represent tree-like data, eg. a file explorer. A rendered tree can always be rendered as a list; it is each row's indentation level and twistie indicators which give the user the perception of tree structure. By leveraging the virtual rendering functionalites of the list we can use composition to create a tree widget.</p>
<p>There is the question of API: how can we keep a tree-like structure API relatively simple, yet allow for complex operations, such as removing and inserting whole subtrees? If we take the same <code>splice</code> analogy as the list's (pick a location, remove some elements and add other elements), it's possible to come up with a tree <code>splice</code> call, in which the location is multi-dimensional (the first element of the <code>start</code> array represents the index in the root's children array; the <code>n</code>-th element of the <code>start</code> array represents the index in the <code>n - 1</code>-th children array) and the elements to insert are entire subtrees.</p>
<div class="highlight"><pre><span></span><span class="kr">interface</span> <span class="nx">TreeElement</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="nx">element</span>: <span class="kt">T</span><span class="p">;</span>
  <span class="nx">children</span>: <span class="kt">TreeElement</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">[];</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">IndexTree</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="nx">splice</span><span class="p">(</span><span class="nx">start</span>: <span class="kt">number</span><span class="p">[],</span> <span class="nx">deleteCount</span>: <span class="kt">number</span><span class="p">,</span> <span class="nx">toInsert</span>: <span class="kt">TreeElement</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">[])</span><span class="o">:</span> <span class="k">void</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>The <code>IndexTree</code>'s main responsibility is to map tree <code>splice</code> calls into list <code>splice</code> calls. It is a composition of the <code>List</code> widget in order to provide enough functionality to render tree-like models with the correct identation levels and twistie states per element. It also provides additional keyboard and mouse handling in order to support tree operations such as expand, collapse, select parent node, etc.</p>
<p>Additionally, the <code>IndexTree</code> supports filtering. An instance of <code>IndexTree</code> can be created with a filter which can have fine grained control of which elements should be filtered out of the view. The <code>filter</code> call can optionally return additional data computed during its operation, which will be passed along to the tree renderer; this is useful in cases where substring highlights are computed during the filtering phase and need to be reused during the rendering phase.</p>
<h3 id="object-tree">Object Tree</h3>
<p>While the <code>IndexTree</code> is both powerful and performant, it also has a sub-optimal API. Often, it is not trivial to compute a <code>start: number[]</code> location to call <code>splice</code> with. It is a much more common scenario to simply replace complete subtrees by addressing an actual element. Given ES6 maps, we can provide just that:</p>
<div class="highlight"><pre><span></span><span class="kr">class</span> <span class="nx">ObjectTree</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="nx">setChildren</span><span class="p">(</span><span class="nx">element</span>: <span class="kt">T</span> <span class="o">|</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">children</span>: <span class="kt">TreeElement</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">[])</span><span class="o">:</span> <span class="k">void</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>The <code>ObjectTree</code> is a mapper between <code>setChildren</code> calls to tree <code>splice</code> calls. Again, it is a composition of the <code>IndexTree</code> widget and provides an API which easier to use since the user can always reference elements already in the tree. The <code>null</code> value is specially reserved to represent the root element.</p>
<h3 id="data-tree">Data Tree</h3>
<p>There are certain use cases in which data models are not fully known: they are lazily discovered. A file explorer is a good example. Once in its initial state, a file explorer renders only the top-level files and folders. Once expanded, a folder should resolve its children by doing some IO and render its children once done. There is an obvious issue: what if the IO is slow?</p>
<div class="highlight"><pre><span></span><span class="kr">interface</span> <span class="nx">IDataSource</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="nx">hasChildren</span><span class="p">(</span><span class="nx">element</span>: <span class="kt">T</span> <span class="o">|</span> <span class="kc">null</span><span class="p">)</span><span class="o">:</span> <span class="kr">boolean</span><span class="p">;</span>
  <span class="nx">getChildren</span><span class="p">(</span><span class="nx">element</span>: <span class="kt">T</span> <span class="o">|</span> <span class="kc">null</span><span class="p">)</span><span class="o">:</span> <span class="nx">Thenable</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">DataTree</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kr">constructor</span><span class="p">(</span><span class="nx">dataSource</span>: <span class="kt">IDataSource</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">);</span>
  <span class="nx">refresh</span><span class="p">(</span><span class="nx">element</span>: <span class="kt">T</span> <span class="o">|</span> <span class="kc">null</span><span class="p">)</span><span class="o">:</span> <span class="nx">Thenable</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>The <code>DataTree</code> abstracts away the user's model using a data source interface. Once again, it is nothing but a composition on top of the <code>ObjectTree</code>. Tree elements can be refreshed via API or by expanding for the very first time. Refreshing a tree element eventually calls the data source which returns a thenable of its children elements. It makes sure to correctly handle conflicting refresh calls (concurrent calls to refresh an ancestor and descendant are problematic) as well as render an appropriate loading indicator for long-running <code>refresh</code> calls, replacing the tree twistie. Once again, the <code>null</code> value represents the root.</p>
<h2 id="performance">Performance</h2>
<p>In order to measure a meaningful performance improvement, we adopted the <code>ObjectTree</code> in the Problems panel. This was a great choice given its simple model (files have problems which have suggested fixes), potential model size (problems can easily grow to the thousands), model update patterns (problems can change very often as the user types, lots of frequent and large updates) as well as desired features (we want the tree to be filtered based on user input).</p>
<p>In order to get a consistent test case, we created a dummy extension which creates fake problems, enough to populate the tree and run a few operations on it. The following example is based on creating a total of 20.000 problems on 10.000 files, 2 problems each:</p>
<ol>
<li>We first set that model on the tree: <strong>Initial Population</strong>;</li>
<li>We then use the filter box to filter down results yet end up typing an expression which matches <strong>all</strong> problems, thus causing no visible changes in the tree, apart from rendering the textual highlights for the matches: <strong>Filter to Same</strong>;</li>
<li>We then use the filter box to filter down results to a single result, by searching for a specific problem: <strong>Filter to One</strong>;</li>
<li>Finally, we run the <strong>Collapse All</strong> action to collapse all tree nodes, which was fairly problematic in the old tree performance wise.</li>
</ol>
<p>Here are the results from profiling all these cases on the same machine along with some speedup calculations:</p>
<table>
<thead>
<tr>
<th>Test</th>
<th>Before</th>
<th>After</th>
<th>Speedup</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Initial population</strong></td>
<td>2.990 ms</td>
<td>524 ms</td>
<td>5.7x</td>
</tr>
<tr>
<td><strong>Filter to Same</strong></td>
<td>1400 ms</td>
<td>204 ms</td>
<td>6.7x</td>
</tr>
<tr>
<td><strong>Filter to One</strong></td>
<td>970 ms</td>
<td>78 ms</td>
<td>12.4x</td>
</tr>
<tr>
<td><strong>Collapse All</strong></td>
<td>30.000 ms 😱</td>
<td>625 ms</td>
<td><strong>48x</strong> 😎</td>
</tr>
</tbody>
</table>
<p>While the speedup results are impressive, some of the absolute values are still unnaceptable: 625ms for collapsing all tree nodes will eat up a large chunk of JavaScript time, drastically reducing our frame rate, even if collapsing all nodes is a punctual operation. The good news is that there is still lots of room for improvement, given that we now have a solid algorithm and data structure foundation on which can iterate much easier. Stay tuned!</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Known-issues/" title="Known issues" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Known issues
              </span>
            </div>
          </a>
        
        
          <a href="../November-Plan/" title="November Plan" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                November Plan
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>